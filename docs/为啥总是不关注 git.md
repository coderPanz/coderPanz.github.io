<!--
 * @Author: qs
 * @Date: 2025-01-24 17:45:53
 * @LastEditTime: 2025-01-25 00:20:37
 * @LastEditors: qs
 * @Description:
 * @FilePath: /coderPanz.github.io/docs/为啥总是不关注 git.md
 *
-->

# git 需要好好学

参考： [廖雪峰的网站](https://liaoxuefeng.com/books/git/what-is-git/index.html)

## what is git

git 是一个分布式版本控制系统，用于多人协助开发和管理代码，有提交记录、分支、版本回退等功能。git 最早用于管理 linux 项目的开发和维护工作，这也是 git 诞生的原因。

## 分布式 vs 集中式

集中式版本控制系统的设计核心是有一个中央服务器存储所有版本数据和历史记录，用户通过从中央服务器获取代码副本来工作。  
集中式特点：

- 单一中央服务器：版本库存储在中央服务器中，开发者需要从服务器拉取代码到本地工作，并将修改提交回服务器。
- 依赖网络连接：用户必须在线才能操作版本控制，如提交代码或查看历史记录。

常用工具：CVS 及 SVN。  
分布式版本控制系统没有“中央服务器”的概念，每个人的电脑上都是一个完整的版本库，这样，你工作的时候，就不需要联网了，因为版本库就在你自己的电脑上。  
特点：

- 无需中央服务器：每个用户都有完整的版本库副本，即使没有网络，也可以完成大部分操作，如提交、查看历史记录等。
- 离线操作：开发者可以在离线状态下完成提交、分支创建等操作。
- 高安全性：每个人电脑里都有完整的版本库，无需担心仓库误操作无法恢复等问题。

## 创建版本库

使用 `git init` 在本地创建 git 仓库，让项目可以使用 git 进行版本管理，`git init` 后这个目录会创建一个 `.git` 文件。  
**注意：** 所有的版本控制系统，其实只能跟踪文本文件的改动，而图片、视频这些二进制文件，虽然也能由版本控制系统管理，但没法跟踪文件的变化，只能把二进制文件每次改动串起来，也就是只知道图片从 100KB 改成了 120KB，但到底改了啥，版本控制系统不知道，也没法知道。

### 将文件放入仓库

- 第一步，用命令 `git add` 告诉 Git，把文件添加到仓库：`git add test.txt`。
- 第二步，用命令 `git commit` 告诉 Git，把文件提交到仓库。`git commit -m "wrote a test file"`  
  -m 后面输入的是本次提交的说明，可以输入任意内容，当然最好是有意义的，一般我们遵循 git 提交规范。

#### 为什么 Git 添加文件需要 add，commit 一共两步呢？

Git 中添加文件需要分为 add 和 commit 两步，主要是为了提供更多的灵活性和控制力。  
 当你修改了工作区的文件后，这些修改并不会立即纳入版本控制。git add 的作用是将工作区中的修改添加到 暂存区（staging area），暂存区是 Git 中一个中间层，允许你在提交之前决定哪些更改应该被包括在下一个提交中。（这样做可以实现选择性的提交，而不是一次提交所有更改，使得提交流程更加灵活。）  
 commit 后会生成版本快照和提交记录，方便记录和版本回退。

## 版本回退

`git log` 命令显示从最近到最远的提交日志，我们可以使用其查看提交记录。  
`git commit` 可以记录版本快照和提交记录，这使得我们可以进行版本回退。首先，Git 必须知道当前版本是哪个版本，在 Git 中，用 HEAD 表示当前版本，上一个版本就是 HEAD^，上上一个版本就是 HEAD^^，当然往上 100 个版本写 100 个^比较容易数不过来，所以写成 HEAD~100。  
`git reset --hard HEAD^` 命令进行版本回退，其中 --hard 参数有啥意义？--hard 会回退到上个版本的**已提交状态（无需 commit 操作）**，而--soft 会回退到上个版本的**未添加到暂存区状态**，--mixed 会回退到上个版本**已添加但未提交的状态**。现在，先放心使用--hard。

### 后悔了怎么办

如果进行版本回退后，需要复用最新版本的一段代码，所以需要回去 copy ，前提是我们需要记住最新版本的 commit id，然后输入 `git reset --hard xxxxxxxx` 即可回到指定版本。  
那如果 commit -id 忘记了怎么办，那就凉拌，在 git 中，存在命令 `git reflog` 用来记录你的每一次命令，可以记录提交信息和 commit id 。  

### 总结
- HEAD指向的版本就是当前版本，因此，Git允许我们在版本的历史之间穿梭，使用命令git reset --hard commit_id。
- 穿梭前，用git log可以查看提交历史，以便确定要回退到哪个版本。
- 要重返未来，用git reflog查看命令历史，以便确定要回到未来的哪个版本。  


## 工作区与暂存区
  工作区：就是你在电脑里能看到的目录，项目所在的目录。工作区中有一个 `.git` 文件，是隐藏起来的，这个不算工作区，而是Git的版本库。  
  Git的版本库里存了很多东西，其中最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的第一个分支master，以及指向 master的一个指针叫HEAD。  
![斩神](/git暂存区.png)